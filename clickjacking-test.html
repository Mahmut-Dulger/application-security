<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Clickjacking Attack Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background-color: #f0f0f0;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        h1 {
            color: #d9534f;
            border-bottom: 2px solid #d9534f;
            padding-bottom: 10px;
        }
        .warning {
            background-color: #fcf8e3;
            border: 1px solid #faebcc;
            color: #8a6d3b;
            padding: 15px;
            margin: 20px 0;
            border-radius: 4px;
        }
        .test-section {
            margin: 30px 0;
        }
        iframe {
            border: 3px solid #d9534f;
            margin: 20px 0;
            display: block;
        }
        .overlay-demo {
            position: relative;
            display: inline-block;
        }
        .fake-button {
            position: absolute;
            top: 200px;
            left: 300px;
            background-color: #5cb85c;
            color: white;
            padding: 15px 30px;
            border: none;
            border-radius: 5px;
            font-size: 18px;
            cursor: pointer;
            pointer-events: none;
            opacity: 0.9;
        }
        .info {
            background-color: #d9edf7;
            border: 1px solid #bce8f1;
            color: #31708f;
            padding: 15px;
            margin: 20px 0;
            border-radius: 4px;
        }
        code {
            background-color: #f5f5f5;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üéØ Clickjacking Vulnerability Test</h1>
        
        <div class="warning">
            <strong>‚ö†Ô∏è Warning:</strong> This is a simulated attack page used for security testing purposes only.
            It attempts to embed your application in an iframe to test for Clickjacking vulnerabilities.
        </div>

        <div class="info">
            <h3>What is Clickjacking?</h3>
            <p>Clickjacking (also known as UI redressing) is an attack where a malicious website tricks users into clicking on something different from what they perceive, potentially revealing confidential information or allowing unauthorized access to their accounts.</p>
        </div>

        <div class="test-section">
            <h2>Test 1: Basic Iframe Embedding</h2>
            <p>Attempting to embed <code>http://localhost:8080</code> in an iframe:</p>
            <iframe src="http://localhost:8080" width="800" height="600" id="test-iframe-1">
                Your browser does not support iframes.
            </iframe>
            <p id="result-1" style="margin-top: 10px; font-weight: bold;"></p>
        </div>

        <div class="test-section">
            <h2>Test 2: Login Page in Iframe</h2>
            <p>Attempting to embed the login page <code>http://localhost:8080/login</code>:</p>
            <iframe src="http://localhost:8080/login" width="800" height="600" id="test-iframe-2">
                Your browser does not support iframes.
            </iframe>
            <p id="result-2" style="margin-top: 10px; font-weight: bold;"></p>
        </div>

        <div class="test-section">
            <h2>Test 3: Clickjacking Attack Simulation</h2>
            <p>This simulates an overlay attack where a fake button would be placed over the real application:</p>
            <div class="overlay-demo">
                <iframe src="http://localhost:8080/signup" width="800" height="600" id="test-iframe-3">
                    Your browser does not support iframes.
                </iframe>
                <button class="fake-button">üéÅ Click for Free Prize!</button>
            </div>
            <p id="result-3" style="margin-top: 10px; font-weight: bold;"></p>
            <p style="color: #666; font-size: 14px;"><em>In a real attack, the fake button would be clickable and positioned over sensitive actions in the framed page.</em></p>
        </div>

        <div class="test-section">
            <h2>üìä Test Results</h2>
            <div id="final-results" style="padding: 20px; background-color: #f9f9f9; border-radius: 4px; margin-top: 20px;">
                <p><strong>Checking iframe loading status...</strong></p>
            </div>
        </div>

        <div class="info" style="margin-top: 30px;">
            <h3>Expected Outcomes:</h3>
            <ul>
                <li><strong>‚úÖ Protected:</strong> Iframes show blank/error, browser console shows <code>X-Frame-Options</code> or CSP error</li>
                <li><strong>‚ùå Vulnerable:</strong> Application loads inside iframe and is interactive</li>
            </ul>
            <p><strong>Check your browser's Developer Console (F12) for security header messages.</strong></p>
        </div>
    </div>

    <script>
        // Test if iframes loaded successfully
        setTimeout(() => {
            const results = [];
            
            for (let i = 1; i <= 3; i++) {
                const iframe = document.getElementById(`test-iframe-${i}`);
                const resultEl = document.getElementById(`result-${i}`);
                
                try {
                    // Try to access iframe content (will fail if X-Frame-Options blocks it)
                    const iframeDoc = iframe.contentDocument || iframe.contentWindow.document;
                    
                    if (iframeDoc && iframeDoc.body && iframeDoc.body.innerHTML.length > 0) {
                        resultEl.innerHTML = '‚ùå <span style="color: red;">VULNERABLE - Iframe loaded successfully!</span>';
                        resultEl.style.color = 'red';
                        results.push(false);
                    } else {
                        resultEl.innerHTML = '‚úÖ <span style="color: green;">PROTECTED - Iframe blocked or empty</span>';
                        resultEl.style.color = 'green';
                        results.push(true);
                    }
                } catch (e) {
                    // Cross-origin error means it might be loading but we can't access it
                    resultEl.innerHTML = '‚ö†Ô∏è <span style="color: orange;">Cross-origin restriction (check browser console for details)</span>';
                    resultEl.style.color = 'orange';
                    results.push(null);
                }
            }
            
            // Final results
            const finalResultsDiv = document.getElementById('final-results');
            const allProtected = results.every(r => r === true || r === null);
            const anyVulnerable = results.some(r => r === false);
            
            if (anyVulnerable) {
                finalResultsDiv.innerHTML = `
                    <h3 style="color: red;">üö® VULNERABILITY DETECTED!</h3>
                    <p>Your application is vulnerable to Clickjacking attacks. The iframes loaded successfully.</p>
                    <h4>Recommended Mitigations:</h4>
                    <ul>
                        <li>Add <code>X-Frame-Options: DENY</code> or <code>SAMEORIGIN</code> header</li>
                        <li>Add CSP <code>frame-ancestors 'none'</code> directive</li>
                        <li>Use <code>helmet</code> middleware with proper configuration</li>
                    </ul>
                `;
            } else {
                finalResultsDiv.innerHTML = `
                    <h3 style="color: green;">‚úÖ APPLICATION IS PROTECTED!</h3>
                    <p>The iframes were blocked from loading your application. Check the browser console for security header messages.</p>
                    <p>Expected messages:</p>
                    <ul>
                        <li><code>Refused to display ... in a frame because it set 'X-Frame-Options' to 'deny'</code>, or</li>
                        <li><code>Refused to frame ... because an ancestor violates the following Content Security Policy directive: "frame-ancestors 'none'"</code></li>
                    </ul>
                `;
            }
        }, 3000);

        // Monitor console for CSP/X-Frame-Options errors
        window.addEventListener('error', (e) => {
            console.log('Error detected:', e);
        }, true);
    </script>
</body>
</html>
